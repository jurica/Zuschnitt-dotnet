@using Zuschnitt.Models;

@inject AppState AppState;

@if (AppState.Project.SelectedSheet != null)
{
    <FluentSplitter Orientation="Orientation.Horizontal" style="width: 100%; height: 100%">
        <Panel1>
            <div Style="padding: 10px;">
                <SheetSelector Sheet="AppState.Project.SelectedSheet"/>
                <SheetSVG Sheet="AppState.Project.SelectedSheet" PartClicked="PartClicked"/>
            </div>
        </Panel1>
        <Panel2>
            <FluentHorizontalScroll @ref="_horizontalScroll" View="HorizontalScrollView.Mobile" Style="--scroll-align: flex-start; padding: 10px">
                @{
                    foreach (var column in AppState.Project.SelectedSheet.Columns)
                    {
                        <ColumnCard Column="column"/>
                    }
                }
            </FluentHorizontalScroll>
        </Panel2>
    </FluentSplitter>
}

@code
{
    FluentHorizontalScroll _horizontalScroll = default!;

    protected override void OnInitialized()
    {
        AppState.OnStateChange += StateHasChanged;
    }

    public void PartClicked(Part part)
    {
        _horizontalScroll.ScrollInView(part.Parent.Pos());
    }
}