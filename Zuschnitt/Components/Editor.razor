@using Zuschnitt.Models;

@inject AppState AppState;

<FluentSplitter Orientation="Orientation.Horizontal" style="width: 100%; height: 100%">
    <Panel1>
        <div Style="padding: 10px;">
            <SheetSelector Sheet="AppState.SelectedSheet"/>
            <SheetSVG Sheet="AppState.SelectedSheet" PartClicked="PartClicked" />
        </div>
    </Panel1>
    <Panel2>
        <FluentHorizontalScroll @ref="_horizontalScroll" View="HorizontalScrollView.Mobile" Style="--scroll-align: flex-start; padding: 10px">
            @{
                foreach (var column in AppState.SelectedSheet.Columns)
                {
                    <ColumnCard Column="column"/>
                }
            }
        </FluentHorizontalScroll>
    </Panel2>
</FluentSplitter>

@code
{
    FluentHorizontalScroll _horizontalScroll = default!;

    protected override void OnInitialized()
    {
        AppState.OnStateChange += StateHasChanged;
    }

    public void PartClicked(Part part)
    {
        var column = AppState.SelectedSheet.Columns .First(c => c.Parts.Contains(part));
        var index = AppState.SelectedSheet.Columns.IndexOf(column);
        _horizontalScroll.ScrollInView(index);
    }
}